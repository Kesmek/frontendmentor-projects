---
import DollarIcon from "./images/icon-dollar.svg";
import PersonIcon from "./images/icon-person.svg";
import Logo from "./images/logo.svg";
---

<article class="calculator">
  <Logo class="logo" />
  <form class="form">
    <div class="entry">
      <div class="input-group">
        <label for="bill-total" class="input-label">Bill</label>
        <span class="input-error" aria-live="polite" id="bill-error"></span>
        <div class="input-container">
          <DollarIcon class="icon" />
          <input
            type="number"
            class="input"
            placeholder="0"
            min="0"
            step="0.01"
            aria-describedby="bill-error"
            id="bill-total"
            name="total"
            required
          />
        </div>
      </div>
      <fieldset class="input-group tips-container">
        <label class="input-label" for="tip-custom">Select Tip %</label>
        <span class="input-error" aria-live="polite" id="tip-error"></span>
        <label for="tip-5" class="tip-button">5%</label>
        <input
          type="radio"
          value="5"
          id="tip-5"
          name="tip-amount"
          class="tip-radio"
        />
        <label for="tip-10" class="tip-button">10%</label>
        <input
          type="radio"
          value="10"
          id="tip-10"
          name="tip-amount"
          class="tip-radio"
        />
        <label for="tip-15" class="tip-button">15%</label>
        <input
          type="radio"
          value="15"
          id="tip-15"
          name="tip-amount"
          class="tip-radio"
        />
        <label for="tip-25" class="tip-button">25%</label>
        <input
          type="radio"
          value="25"
          id="tip-25"
          name="tip-amount"
          class="tip-radio"
        />
        <label for="tip-50" class="tip-button">50%</label>
        <input
          type="radio"
          value="50"
          id="tip-50"
          name="tip-amount"
          class="tip-radio"
        />
        <div class="input-container">
          <input
            type="number"
            placeholder="Custom"
            class="input"
            id="tip-custom"
            aria-describedby="tip-error"
            name="tip-amount"
            max="999"
            min="0"
          />
        </div>
      </fieldset>
      <div class="input-group">
        <label for="num-people" class="input-label">Number of people</label>
        <span class="input-error" aria-live="polite" id="num-people-error"
        ></span>
        <div class="input-container">
          <PersonIcon class="icon" />
          <input
            type="number"
            class="input"
            id="num-people"
            name="num-people"
            aria-describedby="num-people-error"
            placeholder="0"
            max="999"
            min="1"
            required
          />
        </div>
      </div>
    </div>
    <div class="output">
      <div class="output-groups">
        <div class="output-group">
          <p class="output-label">Tip Amount</p>
          <p class="output-sublabel">/ person</p>
          <output
            for="bill-total tip-amount num-people"
            class="output-value"
            id="tip-per-person">$0.00</output
          >
        </div>
        <div class="output-group">
          <p class="output-label">Total</p>
          <p class="output-sublabel">/ person</p>
          <output
            for="bill-total tip-amount num-people"
            class="output-value"
            id="total-per-person">$0.00</output
          >
        </div>
      </div>
      <button type="reset" class="reset-btn" id="reset-btn" disabled
        >Reset</button
      >
    </div>
  </form>
</article>
<script src="./calculator.ts"></script>

<style>
  @layer components {
    :root {
      --calculator-green-400: hsl(172deg 67% 45%);
      --calculator-green-900: hsl(183deg 100% 15%);
      --calculator-grey-50: hsl(189deg 47% 97%);
      --calculator-grey-200: hsl(185deg 41% 84%);
      --calculator-grey-400: hsl(184deg 14% 56%);
      --calculator-grey-500: hsl(186deg 14% 43%);
      --color-background: var(--calculator-grey-200);
    }

    .calculator {
      font-size: 24px;
      font-family: var(--space-mono);
      display: flex;
      flex-direction: column;
      gap: var(--size-5);
      align-items: center;
      inline-size: 100%;
      container-type: inline-size;
    }

    .form {
      display: grid;
      gap: var(--size-6);
      background: var(--color-white);
      border-start-start-radius: var(--radius-3);
      border-start-end-radius: var(--radius-3);
      inline-size: 100%;
      padding: var(--size-5);
    }

    .entry {
      display: flex;
      flex-direction: column;
      gap: var(--size-8);
    }

    .input-group {
      display: grid;
      grid-template: repeat(2, auto) / repeat(2, 1fr);
      gap: var(--size-2);
      font-size: var(--font-size-2);
    }

    .input-container {
      grid-column: 1 / -1;
      background: var(--calculator-grey-50);
      display: flex;
      flex-direction: row;
      align-items: center;
      border-radius: var(--radius-2);
      overflow: clip;
      padding: var(--size-2);
      font-size: var(--font-size-4);

      &:focus-within {
        outline: var(--border-size-2) solid var(--calculator-green-400);
      }

      &:has(input:user-invalid) {
        outline: var(--border-size-2) solid var(--color-red-600);
      }
    }

    .input {
      color: var(--calculator-green-900);
      inline-size: 100%;
      padding: 0;
      padding-inline-end: var(--size-2);
      display: block;
      text-align: right;
      border: none;
      background: transparent;

      &:focus-visible {
        outline: none;
      }
    }

    .input-label {
      font-size: var(--font-size-2);
      color: var(--calculator-grey-500);
    }

    .input-error {
      color: var(--color-red-900);
      font-size: var(--font-size-2);
      grid-column: 2 / -1;
      justify-self: end;
    }

    .tip-radio {
      inline-size: 0;
      position: absolute;
    }

    .tip-button {
      color: var(--color-white);
      background: var(--calculator-green-900);
      display: flex;
      justify-content: center;
      padding: var(--size-2) var(--size-6);
      border-radius: var(--radius-2);
      transition-property: color, background;
      transition-duration: var(--duration-quick-1);

      &:hover,
      &:has(+ .tip-radio:checked) {
        background: var(--calculator-green-400);
        cursor: pointer;
        color: var(--calculator-green-900);
      }

      &:active {
        background: oklch(from var(--calculator-green-400) calc(l * 1.1) c h);
      }
    }

    .tips-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: auto;
      font-size: inherit;
      gap: var(--size-3);
      border: none;
      padding: 0;

      & .input-container {
        grid-column: span 1;
      }
    }

    .output {
      background: var(--calculator-green-900);
      padding: var(--size-6);
      padding-block-start: var(--size-8);
      display: flex;
      flex-direction: column;
      border-radius: var(--radius-3);
      justify-content: space-between;
      gap: var(--size-6);
    }

    .output-groups {
      display: flex;
      flex-direction: column;
      gap: var(--size-6);
    }

    .output-group {
      display: grid;
      align-items: center;
      column-gap: var(--size-6);
      row-gap: var(--size-3);
      grid-template-columns: auto 1fr;
      grid-auto-flow: column;
    }

    .output-label {
      font-size: var(--font-size-2);
      color: var(--color-white);
    }

    .output-sublabel {
      font-size: var(--font-size-1);
      color: var(--calculator-grey-500);
    }

    .output-value {
      font-size: var(--font-size-6);
      color: var(--calculator-green-400);
      text-align: end;
      text-box: trim-both cap alphabetic;
      grid-row: span 2;
      align-self: center;
    }

    .reset-btn {
      background: var(--calculator-green-400);
      color: var(--calculator-green-900);
      padding: var(--size-4);
      text-transform: uppercase;
      border: none;
      border-radius: var(--radius-2);

      &:hover:not(:disabled) {
        background: oklch(from var(--calculator-green-400) calc(l * 1.2) c h);
        cursor: pointer;
      }

      &:active:not(:disabled) {
        background: oklch(from var(--calculator-green-400) calc(l * 1.3) c h);
      }

      &:disabled {
        opacity: 0.3;
        cursor: unset;
      }
    }

    @container (inline-size > 40rem) {
      .tips-container {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @container (inline-size > 60rem) {
      .form {
        grid-template-columns: 1fr auto;
        max-inline-size: var(--size-18);
        border-radius: var(--radius-4);
      }

      .entry {
        padding: var(--size-4);
      }

      .output {
        padding: var(--size-8);
      }
    }
  }
</style>
